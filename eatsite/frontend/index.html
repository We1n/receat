<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="description" content="Shared Pantry - учёт продуктов для двух устройств">
  <meta name="theme-color" content="#6366f1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Pantry">
  <title>Shared Pantry</title>
  <link rel="icon" type="image/x-icon" href="/eat/favicon.ico">
  <link rel="manifest" href="/eat/manifest.webmanifest">
  <!-- PWA meta tags -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Pantry">
</head>
<body>
  <div id="app">
    <!-- Public Landing (если нет доступа) -->
    <div id="public-landing" class="screen hidden">
      <h1>Shared Pantry</h1>
      <p>Введите invite-ссылку для доступа к workspace</p>
      <input type="text" id="workspace-input" placeholder="workspace_id">
      <button id="join-btn">Присоединиться</button>
    </div>

    <!-- Menu Screen (главный экран с табами) -->
    <div id="menu-screen" class="screen hidden">
      <header class="menu-header">
        <h1>Меню</h1>
        <div class="header-actions">
          <button id="theme-toggle-btn" class="theme-toggle-btn" title="Переключить тему" aria-label="Переключить тему">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            <svg class="icon icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
          </button>
          <button id="faq-btn" class="faq-btn" title="Помощь и FAQ" aria-label="Помощь и FAQ">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
          </button>
          <button id="switch-workspace-btn" class="switch-workspace-btn" title="Сменить воркспейс" aria-label="Сменить воркспейс">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23 4 23 10 17 10"></polyline>
              <polyline points="1 20 1 14 7 14"></polyline>
              <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
          </button>
        </div>
      </header>
      
      <!-- Tab Navigation -->
      <div class="tab-navigation" role="tablist">
        <button class="tab-btn active" data-tab="home" role="tab" aria-selected="true" aria-controls="tab-panel-home">
          <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
          <span class="tab-label">Дома</span>
        </button>
        <button class="tab-btn" data-tab="need" role="tab" aria-selected="false" aria-controls="tab-panel-need">
          <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          <span class="tab-label">Нужно</span>
        </button>
        <button class="tab-btn" data-tab="base" role="tab" aria-selected="false" aria-controls="tab-panel-base">
          <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
          </svg>
          <span class="tab-label">Базовая</span>
        </button>
        <button class="tab-btn" data-tab="wishlist" role="tab" aria-selected="false" aria-controls="tab-panel-wishlist">
          <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
          </svg>
          <span class="tab-label">Хочухи</span>
        </button>
      </div>

      <!-- Tab Panels -->
      <div class="tab-panels">
        <!-- Дома (In Stock) -->
        <div id="tab-panel-home" class="tab-panel active" role="tabpanel" aria-labelledby="tab-home">
          <div id="products-in-list"></div>
        </div>

        <!-- Нужно (Out of Stock) -->
        <div id="tab-panel-need" class="tab-panel" role="tabpanel" aria-labelledby="tab-need">
          <div id="products-out-list"></div>
        </div>

        <!-- Базовая корзина -->
        <div id="tab-panel-base" class="tab-panel" role="tabpanel" aria-labelledby="tab-base">
          <div class="base-basket-content">
            <div class="info-card">
              <h2>Базовая корзина</h2>
              <p>Настройте стандартный набор продуктов, который можно добавить одним нажатием</p>
              <div class="base-basket-actions">
                <button id="edit-basket-btn" class="edit-basket-btn">
                  <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                  </svg>
                  Редактировать корзину
                </button>
                <button id="init-basket-btn" class="init-basket-btn">
                  <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                  </svg>
                  Добавить в "Нужно купить"
                </button>
              </div>
            </div>
            <div id="base-basket-list" class="base-basket-list"></div>
          </div>
        </div>

        <!-- Хочухи (Wishlist) -->
        <div id="tab-panel-wishlist" class="tab-panel" role="tabpanel" aria-labelledby="tab-wishlist">
          <div id="wishlist-list"></div>
        </div>
      </div>
    </div>

    <!-- Product Add/Edit -->
    <div id="product-edit" class="screen hidden">
      <header>
        <h2 id="edit-product-name">Новый продукт</h2>
        <button id="close-edit-btn">Закрыть</button>
      </header>
      <form id="product-edit-form">
        <label>
          Название:
          <input type="text" id="edit-name" required>
        </label>
        <label>
          Категория:
          <select id="edit-category" required>
            <option value="">Выберите категорию</option>
          </select>
        </label>
        <label>
          <input type="checkbox" id="edit-in-stock"> В наличии
        </label>
        <label>
          <input type="checkbox" id="edit-wishlist">
          <svg class="icon-inline" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
          </svg>
          В хочухи
        </label>
        <label>
          Количество:
          <input type="number" id="edit-quantity" step="0.1" min="0" placeholder="1, 0.5, 2.5...">
          <small class="hint">Для штук (шт) - только целые числа</small>
        </label>
        <label>
          Единица измерения:
          <input type="text" id="edit-unit" placeholder="кг, л, шт, банки..." list="unit-suggestions">
          <datalist id="unit-suggestions">
            <option value="кг">
            <option value="г">
            <option value="л">
            <option value="мл">
            <option value="шт">
            <option value="банки">
            <option value="пачки">
            <option value="упаковки">
          </datalist>
        </label>
        <div class="form-actions">
          <button type="submit">Сохранить</button>
          <button type="button" id="delete-product-btn" class="delete-btn" style="display: none;">Удалить</button>
        </div>
      </form>
    </div>

    <!-- Recipes -->
    <div id="recipes" class="screen hidden">
      <header>
        <h1>Рецепты</h1>
        <div class="header-actions">
          <button id="add-recipe-btn">+ Добавить рецепт</button>
        </div>
      </header>
      <div id="recipes-list"></div>
    </div>

    <!-- Recipe Add/Edit -->
    <div id="recipe-edit" class="screen hidden">
      <header>
        <h2 id="edit-recipe-name">Новый рецепт</h2>
        <button id="close-recipe-btn">Закрыть</button>
      </header>
      <form id="recipe-edit-form">
        <label>
          Название:
          <input type="text" id="edit-recipe-name-input" required>
        </label>
        <label>
          Продукты (через запятую, ID или названия):
          <input type="text" id="edit-recipe-products" placeholder="product_id1, product_id2">
        </label>
        <label>
          Заметки:
          <textarea id="edit-recipe-notes" rows="4"></textarea>
        </label>
        <div class="form-actions">
          <button type="submit">Сохранить</button>
          <button type="button" id="delete-recipe-btn" class="delete-btn" style="display: none;">Удалить</button>
        </div>
      </form>
    </div>

  </div>

  <!-- Bottom Navigation - вне #app для правильного позиционирования -->
  <nav id="bottom-nav" class="bottom-nav" role="navigation" aria-label="Основная навигация">
    <button class="nav-item" id="nav-products-tab" aria-label="Продукты" aria-current="page">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
      <span class="nav-label">Продукты</span>
    </button>
    <button class="nav-item nav-item-add" id="add-product-btn" aria-label="Добавить продукт">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
    </button>
    <button class="nav-item" id="nav-recipes-tab" aria-label="Рецепты">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
      </svg>
      <span class="nav-label">Рецепты</span>
    </button>
  </nav>

  <script type="module" src="/main.js"></script>
</body>
</html>

